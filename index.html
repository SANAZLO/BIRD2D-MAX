<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Eagle Journey: –í—ã–±–æ—Ä –ü—Ç–∏—Ü</title>
    <style>
        body { margin: 0; overflow: hidden; background: #0b1522; font-family: 'Segoe UI', sans-serif; touch-action: none; }
        canvas { display: block; }
        
        #ui { position: fixed; top: 20px; width: 100%; text-align: center; color: white; pointer-events: none; z-index: 10; }
        .score { font-size: 50px; font-weight: bold; text-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        #timer { font-size: 70px; color: #f1c40f; position: fixed; top: 35%; left: 50%; transform: translate(-50%, -50%); text-shadow: 0 0 20px rgba(0,0,0,0.5); z-index: 50; }

        /* –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ */
        #menu {
            position: fixed; inset: 0; background: rgba(0,5,15,0.9);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 200; color: white;
        }
        .bird-options { display: flex; gap: 20px; margin-top: 30px; }
        .bird-card { 
            padding: 20px; border: 2px solid #333; border-radius: 15px; 
            cursor: pointer; transition: 0.3s; text-align: center; background: #1a2a6c;
        }
        .bird-card:hover { border-color: #f1c40f; transform: scale(1.1); }
        .bird-card img { width: 60px; display: block; margin-bottom: 10px; }

        #game-over {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            display: none; flex-direction: column; align-items: center; justify-content: center;
            z-index: 100; color: white;
        }
        .btn { padding: 15px 50px; background: #c0392b; border: none; color: white; font-size: 20px; cursor: pointer; border-radius: 5px; margin-top: 20px; }
    </style>
</head>
<body>

    <div id="menu">
        <h1>–í–´–ë–ï–†–ò –°–í–û–Æ –ü–¢–ò–¶–£</h1>
        <div class="bird-options">
            <div class="bird-card" onclick="startGame('#3e2723', '#fff')">
                <div style="font-size:40px">ü¶Ö</div>
                <div>–û–†–ï–õ</div>
            </div>
            <div class="bird-card" onclick="startGame('#e67e22', '#f1c40f')">
                <div style="font-size:40px">üî•</div>
                <div>–§–ï–ù–ò–ö–°</div>
            </div>
            <div class="bird-card" onclick="startGame('#2c3e50', '#8e44ad')">
                <div style="font-size:40px">üê¶</div>
                <div>–í–û–†–û–ù</div>
            </div>
        </div>
    </div>

    <div id="ui" style="display:none">
        <div class="score" id="score">0</div>
        <div id="best-ui" style="opacity: 0.6;">–†–ï–ö–û–†–î: 0</div>
    </div>

    <div id="timer"></div>

    <div id="game-over">
        <h1 style="color:#e74c3c">–°–¢–û–õ–ö–ù–û–í–ï–ù–ò–ï</h1>
        <button class="btn" onclick="location.reload()">–í –ú–ï–ù–Æ</button>
    </div>

    <canvas id="game"></canvas>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const timerEl = document.getElementById('timer');
const menu = document.getElementById('menu');

let w, h, bird, pipes, score, isOver, frame, gameStarted, birdColor, headColor;

// –ü–õ–ê–í–ù–ê–Ø –§–ò–ó–ò–ö–ê (–∫–∞–∫ –ø—Ä–æ—Å–∏–ª–∏)
const GRAVITY = 0.15; 
const FLAP = -4.5; 
const SPEED = 3.0;

function startGame(body, head) {
    birdColor = body;
    headColor = head;
    menu.style.display = 'none';
    document.getElementById('ui').style.display = 'block';
    init();
}

function init() {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
    score = 0;
    isOver = false;
    frame = 0;
    gameStarted = false;
    pipes = [];
    
    bird = { x: w * 0.25, y: h / 2, v: 0, angle: 0, wing: 0 };
    
    // –§–û–†–ê 3 –°–ï–ö–£–ù–î–´
    let count = 3;
    timerEl.innerText = "–ü–†–ò–ì–û–¢–û–í–ò–¢–¨–°–Ø...";
    let t = setInterval(() => {
        count--;
        if(count <= 0) { clearInterval(t); timerEl.innerText = ""; gameStarted = true; }
        else { timerEl.innerText = count; }
    }, 1000);
}

function drawBird() {
    ctx.save();
    ctx.translate(bird.x, bird.y);
    bird.angle = Math.min(Math.PI/6, Math.max(-Math.PI/6, bird.v * 0.08));
    ctx.rotate(bird.angle);
    
    // –ö—Ä—ã–ª—å—è
    ctx.fillStyle = birdColor;
    let s = Math.sin(bird.wing) * 20;
    ctx.beginPath(); ctx.moveTo(-15, 0); ctx.quadraticCurveTo(0, -s - 25, 15, 0); ctx.fill();

    // –¢–µ–ª–æ
    ctx.beginPath(); ctx.ellipse(0, 0, 25, 10, 0, 0, Math.PI*2); ctx.fill();
    
    // –ì–æ–ª–æ–≤–∞
    ctx.fillStyle = headColor;
    ctx.beginPath(); ctx.arc(17, -4, 9, 0, Math.PI*2); ctx.fill();

    // –ö–ª—é–≤
    ctx.fillStyle = '#f39c12';
    ctx.beginPath(); ctx.moveTo(23, -4); ctx.lineTo(33, -1); ctx.lineTo(23, 2); ctx.fill();
    ctx.restore();
}

function update() {
    if(!gameStarted || isOver) {
        bird.y = h/2 + Math.sin(frame*0.05)*10;
        frame++; return;
    }

    bird.v += GRAVITY;
    bird.y += bird.v;
    bird.wing += 0.15;

    if(frame % 140 === 0) {
        let gap = 280;
        let topH = 100 + Math.random() * (h - gap - 200);
        pipes.push({x: w, w: 90, h: topH, type: 'top', passed: false});
        pipes.push({x: w, w: 90, h: h - topH - gap, type: 'bot'});
    }

    pipes.forEach((p, i) => {
        p.x -= SPEED;
        if(bird.x + 15 > p.x && bird.x - 15 < p.x + p.w) {
            if(p.type === 'top' && bird.y - 10 < p.h) isOver = true;
            if(p.type === 'bot' && bird.y + 10 > h - p.h) isOver = true;
        }
        if(!p.passed && p.type === 'top' && p.x < bird.x) {
            score++; p.passed = true;
            document.getElementById('score').innerText = score;
        }
        if(p.x < -100) pipes.splice(i, 1);
    });

    if(bird.y > h || bird.y < 0) isOver = true;
    if(isOver) document.getElementById('game-over').style.display = 'flex';
    frame++;
}

function loop() {
    ctx.fillStyle = '#1565c0';
    ctx.fillRect(0,0,w,h);
    
    // –ü—Ä–æ—Å—Ç–æ–π —Ñ–æ–Ω (–æ–±–ª–∞–∫–∞)
    ctx.fillStyle = 'rgba(255,255,255,0.2)';
    for(let i=0; i<3; i++) ctx.beginPath(), ctx.arc((w+100-frame*(i+1)*0.5)%w, 100+i*100, 40, 0, Math.PI*2), ctx.fill();

    pipes.forEach(p => {
        ctx.fillStyle = p.type === 'top' ? '#34495e' : '#1b5e20';
        ctx.fillRect(p.x, p.type === 'top' ? 0 : h - p.h, p.w, p.h);
    });

    drawBird();
    update();
    requestAnimationFrame(loop);
}

loop();
window.onkeydown = (e) => { if(e.code === 'Space') bird.v = FLAP; };
canvas.ontouchstart = (e) => { bird.v = FLAP; e.preventDefault(); };
window.onresize = () => { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; };
</script>
</body>
</html>
